<!DOCTYPE html> <html lang="en"> <head> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>DYffusion: A Dynamics-informed Diffusion Model for Spatiotemporal Forecasting | Salva Rühling Cachay</title> <meta name="author" content="Salva Rühling Cachay"/> <meta name="description" content="The personal website Salva Rühling Cachay . "/> <meta name="keywords" content="Salva Rühling Cachay, machine learning, AI, artificial intelligence, deep learning, climate, weather, generative modeling"/> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"/> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="none" id="highlight_theme_light"/> <link rel="shortcut icon" href="/assets/img/favicon.ico"/> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://salvarc.github.io/blog/2023/dyffusion-post/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"/> <script src="/assets/js/theme.js"></script> <script src="/assets/js/dark_mode.js"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-bolder" href="https://salvarc.github.io/">Salva Rühling Cachay</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv</a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications</a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">repositories</a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog<span class="sr-only">(current)</span></a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">DYffusion: A Dynamics-informed Diffusion Model for Spatiotemporal Forecasting</h1> <p class="post-meta">December 5, 2023• <a href="https://salvarc.github.io/">Salva Rühling Cachay</a>, <a href="https://b-zhao.github.io/" target="_blank" rel="noopener noreferrer">Bo Zhao</a>, <a href="https://haileyjoren.github.io/" target="_blank" rel="noopener noreferrer">Hailey Joren</a>, <a href="https://roseyu.com/" target="_blank" rel="noopener noreferrer">Rose Yu</a></p> <p class="post-tags"> <a href="/blog/2023"> <i class="fas fa-calendar fa-sm"></i> 2023 </a>   ·   <a href="/blog/tag/dyffusion,"> <i class="fas fa-hashtag fa-sm"></i> dyffusion,</a>   <a href="/blog/tag/diffusion"> <i class="fas fa-hashtag fa-sm"></i> diffusion</a>   <a href="/blog/tag/model,"> <i class="fas fa-hashtag fa-sm"></i> model,</a>   <a href="/blog/tag/spatiotemporal,"> <i class="fas fa-hashtag fa-sm"></i> spatiotemporal,</a>   <a href="/blog/tag/forecasting,"> <i class="fas fa-hashtag fa-sm"></i> forecasting,</a>   <a href="/blog/tag/probabilistic,"> <i class="fas fa-hashtag fa-sm"></i> probabilistic,</a>   <a href="/blog/tag/generative"> <i class="fas fa-hashtag fa-sm"></i> generative</a>   <a href="/blog/tag/modeling,"> <i class="fas fa-hashtag fa-sm"></i> modeling,</a>   <a href="/blog/tag/machine"> <i class="fas fa-hashtag fa-sm"></i> machine</a>   <a href="/blog/tag/learning,"> <i class="fas fa-hashtag fa-sm"></i> learning,</a>   <a href="/blog/tag/deep"> <i class="fas fa-hashtag fa-sm"></i> deep</a>   <a href="/blog/tag/learning,"> <i class="fas fa-hashtag fa-sm"></i> learning,</a>   <a href="/blog/tag/neurips"> <i class="fas fa-hashtag fa-sm"></i> neurips</a>     ·   <a href="/blog/category/jekyll"> <i class="fas fa-tag fa-sm"></i> jekyll</a>   <a href="/blog/category/update"> <i class="fas fa-tag fa-sm"></i> update</a>   </p> </header> <article class="post-content"> <p><strong>TL;DR:</strong> We introduce a novel diffusion model-based framework, DYffusion, for large-scale probabilistic forecasting. We propose to couple the diffusion steps with the physical timesteps of the data, leading to temporal forward and reverse processes that we represent through a stochastic interpolator and a deterministic forecaster network, respectively. These design choices effectively address the challenges of generating stable, accurate and probabilistic rollout forecasts.</p> <div align="center"> ![DYffusion Diagram](https://media.giphy.com/media/v1.Y2lkPTc5MGI3NjExOXpvdHB5bGY1aWltbTdoYTdxNW03bmdxaG9tMDN6dGY1ZTZ2OWU5ZCZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/h7yQszDENzsSiIUOpJ/giphy.gif) *DYffusion forecasts a sequence of* $h$ *snapshots* $\mathbf{x}_1, \mathbf{x}_2, \dots, \mathbf{x}_h$ *given the initial conditions* $\mathbf{x}_0$ *similarly to how standard diffusion models are used to sample from a distribution.* </div> <h3 id="motivation-for-our-work">Motivation for our work</h3> <p>Obtaining <em>accurate and reliable probabilistic forecasts</em> is an important component of policy formulation, risk management, resource optimization, and strategic planning with a wide range of applications from climate simulations and fluid dynamics to financial markets and epidemiology. Often, accurate <em>long-range</em> probabilistic forecasts are particularly challenging to obtain. When they exist, physics-based methods typically hinge on computationally expensive numerical simulations. In contrast, data-driven methods are much more efficient and have started to have real-world impact in fields such as <a href="https://www.ecmwf.int/en/about/media-centre/news/2023/how-ai-models-are-transforming-weather-forecasting-showcase-data" target="_blank" rel="noopener noreferrer">global weather forecasting</a>.</p> <p>Generative modeling, and especially diffusion models, have shown great success in other fields such as natural image generation, and video synthesis. Diffusion models iteratively transform data back and forth between an initial distribution and the target distribution over multiple diffusion steps. The standard approach (e.g. see <a href="https://lilianweng.github.io/posts/2021-07-11-diffusion-models/" target="_blank" rel="noopener noreferrer">this excellent blog post</a>) is to corrupt the data with increasing levels of Gaussian noise in the forward process, and to train a neural network to denoise the data in the reverse process. Due to the need to generate data from noise over several sequential steps, diffusion models are expensive to train and, especially, to sample from. Recent works such as <a href="https://arxiv.org/abs/2208.09392" target="_blank" rel="noopener noreferrer">Cold Diffusion</a>, by which our work was especially inspired, have proposed to use alternative data corruption processes like blurring.</p> <p><em><strong>Problem:</strong></em> Common approaches for large-scale spatiotemporal problems tend to be <em>deterministic</em> and <em>autoregressive</em>. As such, they are often unable to capture the inherent uncertainty in the data, produce unphysical predictions, and are prone to error accumulation for long-range forecasts. It is natural to ask how we can efficiently leverage diffusion models for large-scale spatiotemporal problems and incorporate the temporality of the data into the diffusion model.</p> <p>DYffusion presents a natural solution for both these issues, by designing a temporal diffusion model (leads to naturally training to forecast multiple steps) and embedding it into the “generalized diffusion model” framework so that by taking inspiration from existing diffusion models we can build a strong probabilistic forecasting model.</p> <div align="center"> <img src="/assets/2023-12-05-dyffusion/noise-diagram-gaussian.jpg" width="400" height="400" alt="Gaussian diffusion" title="Gaussian noise-based diffusion model"> <img src="/assets/2023-12-05-dyffusion/noise-diagram-dyffusion.jpg" width="400" height="400" alt="DYffusion" title="DYffusion"> </div> <p>DYffusion is the first diffusion model that relies on task-informed forward and reverse processes. All other existing diffusion models, albeit more general, use data corruption-based processes. As a result, our work provides a new perspective on designing a capable diffusion model, and may lead to a whole family of task-informed diffusion models.</p> <p>For more details, please check out our <a href="https://arxiv.org/abs/2306.01984" target="_blank" rel="noopener noreferrer">NeurIPS 2023 paper</a>, and our <a href="https://github.com/Rose-STL-Lab/dyffusion" target="_blank" rel="noopener noreferrer">code on GitHub</a>.</p> </article><div id="disqus_thread"></div> <script type="text/javascript">var disqus_shortname="salvarc-github-io",disqus_identifier="/blog/2023/dyffusion-post",disqus_title="DYffusion: A Dynamics-informed Diffusion Model for Spatiotemporal Forecasting";!function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="//"+disqus_shortname+".disqus.com/embed.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)}();</script> <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript" target="_blank" rel="noopener noreferrer">comments powered by Disqus.</a> </noscript> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2025 Salva Rühling Cachay. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="noopener noreferrer">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" target="_blank" rel="noopener noreferrer">al-folio</a> theme. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="/assets/js/common.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script async src="https://www.googletagmanager.com/gtag/js?id=G-EJL52VZ7F6"></script> <script>function gtag(){window.dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-EJL52VZ7F6");</script> </body> </html>